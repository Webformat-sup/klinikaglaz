var bPlaySetting;$.fn.hasAttr=function(a){return this.attr(a)!==undefined};$(document).ready(function(){var a=new toolbar("access_toolbar",false);if($(".bs-docs-panel").hasClass("voice-panel")){bPlaySetting=true}else{bPlaySetting=false}});var secondClick=false;var duration=3000;$(document).on("click",".btn-exit",function(){var a=$(this);if(a.parents(".bs-docs-panel").hasClass("voice-panel")){playSetting("exit");setTimeout(function(){window.location.href=a.attr("href")},duration);return false}else{return true}});function toolbar(b){this.$id=$("#"+b);this.$rootItems=this.$id.find("button");this.$items=this.$id.find("button");this.$allItems=this.$items;this.$btnGroup=this.$id.find(".btn-group");this.$firstButton=[];for(i=1;i<=this.$btnGroup.length;i++){this.$firstButton[i-1]=this.$btnGroup.eq(i).find("button:first")}this.$activeItem=null;this.keys={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40};this.bindHandlers();if($("#mibok_special_auth_timeout").is("div")){var a=$("#mibok_special_auth_timeout").attr("data-time-out");setInterval(function(){if(!$(".panel-auth").is(".active")){$(".panel-auth").slideDown({duration:"fast",complete:function(){$.scrollTo(".panel-auth","100",function(){$(".panel-auth").addClass("active").attr("aria-hidden","false");$(".panel-auth .help-block").focus();$(".panel-auth h3").attr("tabindex","0");$(".panel-auth p.help-block-default").attr("tabindex","0");$(".panel-auth input").attr("tabindex","0");$(".panel-auth button").attr("tabindex","0")})},start:function(){$focused=$(":focus")}})}},a);$(".panel-auth h3").attr("tabindex","-1");$(".panel-auth p").attr("tabindex","-1");$(".panel-auth input").attr("tabindex","-1");$(".panel-auth button").attr("tabindex","-1")}}toolbar.prototype.bindHandlers=function(){var a=this;this.$items.mouseenter(function(b){if($(this).is(".checked")){$(this).addClass("menu-hover-checked")}else{$(this).addClass("menu-hover")}return true});this.$items.mouseout(function(b){$(this).removeClass("menu-hover menu-hover-checked");return true});this.$allItems.click(function(b){return a.handleClick($(this),b)});this.$allItems.keydown(function(b){return a.handleKeyDown($(this),b)});this.$allItems.keypress(function(b){return a.handleKeyPress($(this),b)});this.$allItems.focus(function(b){return a.handleFocus($(this),b)});this.$allItems.blur(function(b){return a.handleBlur($(this),b)});$(document).click(function(b){return a.handleDocumentClick(b)})};toolbar.prototype.handleClick=function(a,b){this.processMenuChoice(a);this.$allItems.removeClass("menu-hover menu-hover-checked menu-focus menu-focus-checked");b.stopPropagation();return false};toolbar.prototype.handleFocus=function(a,b){if(this.$activeItem==null){this.$activeItem=a}else{if(a[0]!=this.$activeItem[0]){return true}}this.$allItems.removeClass("menu-focus menu-focus-checked");if(this.$activeItem.is(".checked")){this.$activeItem.addClass("menu-focus-checked")}else{this.$activeItem.addClass("menu-focus")}return true};toolbar.prototype.handleBlur=function(a,b){a.removeClass("menu-focus menu-focus-checked");return true};toolbar.prototype.handleKeyDown=function(a,b){if(b.altKey||b.ctrlKey){return true}switch(b.keyCode){case this.keys.tab:this.$allItems.removeClass("menu-focus");this.$activeItem=null;break;case this.keys.esc:b.stopPropagation();return false;case this.keys.enter:case this.keys.space:this.processMenuChoice(a);this.$allItems.removeClass("menu-hover menu-hover-checked");this.$allItems.removeClass("menu-focus menu-focus-checked");this.$activeItem=null;b.stopPropagation();return false;case this.keys.left:this.$activeItem=this.moveToPrevious(a);this.$activeItem.focus();b.stopPropagation();return false;case this.keys.right:this.$activeItem=this.moveToNext(a);this.$activeItem.focus();b.stopPropagation();return false;case this.keys.up:b.stopPropagation();return false;case this.keys.down:b.stopPropagation();return false}return true};toolbar.prototype.moveToNext=function(c){var f=c.parents(".access-toolbar");var g=f.find("button:not(.disabled)");var b=g.length;var e=g.index(c);var d=null;var a=null;if(f.is(".access-toolbar")){if(e<b-1){d=g.eq(e+1)}else{d=g.first()}c.removeClass("menu-focus")}return d};toolbar.prototype.moveToPrevious=function(c){var f=c.parents(".access-toolbar");var g=f.find("button:not(.disabled)");var b=g.length;var e=g.index(c);var d=null;var a=null;if(f.is(".access-toolbar")){if(e>0){d=g.eq(e-1)}else{d=g.last()}c.removeClass("menu-focus")}return d};toolbar.prototype.moveDown=function(a,b){};toolbar.prototype.moveUp=function(a){};toolbar.prototype.handleKeyPress=function(a,b){if(a.hasClass("disabled")){b.stopPropagation()}if(b.altKey||b.ctrlKey||b.shiftKey){return true}switch(b.keyCode){case this.keys.tab:return true;case this.keys.esc:case this.keys.enter:case this.keys.space:case this.keys.up:case this.keys.down:case this.keys.left:case this.keys.right:b.stopPropagation();return false;default:this.$activeItem.focus();b.stopPropagation();return false}return true};toolbar.prototype.handleDocumentClick=function(a){this.$allItems.removeClass("menu-focus menu-focus-checked");this.$activeItem=null;return true};toolbar.prototype.processSetChoice=function(b,a){$.ajax({type:"POST",cache:false,url:this.$id.attr("data-path-params"),data:[{name:b,value:a}],success:function(c){}});return false};toolbar.prototype.processMenuChoice=function(b){var a=b.attr("data-choice");b.parent().find("button").removeClass("checked").attr("aria-checked","false");playSetting(a);switch(a){default:return false;case"content":$.scrollTo("#main_content .page-header:first","100",function(){$("#main_content .page-header:first").focus()});break;case"font-size-100":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("font-size-100");$("#content").removeClass("font-size-150 font-size-200");this.processSetChoice("FONT_SIZE","font-size-100");break;case"font-size-150":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("font-size-150");$("#content").removeClass("font-size-100 font-size-200");this.processSetChoice("FONT_SIZE","font-size-150");break;case"font-size-200":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("font-size-200");$("#content").removeClass("font-size-100 font-size-150");this.processSetChoice("FONT_SIZE","font-size-200");break;case"images":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("images");$("#content").removeClass("not-images");$(".btn-mono").removeClass("disabled");this.processSetChoice("IMAGES","images");break;case"not-images":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("not-images");$("#content").removeClass("images mono");$(".btn-mono").addClass("disabled").removeClass("checked");this.processSetChoice("IMAGES","not-images");break;case"mono":if($("#content").is(".mono")){$("#content").removeClass("mono");this.processSetChoice("MONO_IMAGES","not-mono")}else{b.attr("aria-checked","true").addClass("checked");$("#content").addClass("mono");this.processSetChoice("MONO_IMAGES","mono")}break;case"flash":if($("#content").is(".not-flash")){$("#content").removeClass("not-flash");$("object").css("margin-left",0);this.processSetChoice("FLASH","flash")}else{b.attr("aria-checked","true").addClass("checked");$("#content").addClass("not-flash");$("object").wrap('<div class="fl-wrapper">').parent().css({overflow:"hidden"}).children().css({"margin-left":-99999});this.processSetChoice("FLASH","not-flash")}break;case"color-1":b.attr("aria-checked","true").addClass("checked");$("#content, #c_panel_special").addClass("color-1");$("#content, #c_panel_special").removeClass("color-2 color-3 color-4 color-5");this.processSetChoice("COLOR","color-1");break;case"color-2":b.attr("aria-checked","true").addClass("checked");$("#content, #c_panel_special").addClass("color-2");$("#content, #c_panel_special").removeClass("color-1 color-3 color-4 color-5");this.processSetChoice("COLOR","color-2");break;case"color-3":b.attr("aria-checked","true").addClass("checked");$("#content, #c_panel_special").addClass("color-3");$("#content, #c_panel_special").removeClass("color-1 color-2 color-4 color-5");this.processSetChoice("COLOR","color-3");break;case"color-4":b.attr("aria-checked","true").addClass("checked");$("#content, #c_panel_special").addClass("color-4");$("#content, #c_panel_special").removeClass("color-1 color-2 color-3 color-5");this.processSetChoice("COLOR","color-4");break;case"color-5":b.attr("aria-checked","true").addClass("checked");$("#content, #c_panel_special").addClass("color-5");$("#content, #c_panel_special").removeClass("color-1 color-2 color-3 color-4");this.processSetChoice("COLOR","color-5");break;case"kerning-1":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("kerning-1");$("#content").removeClass("kerning-2 kerning-3");this.processSetChoice("KERNING","kerning-1");break;case"kerning-2":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("kerning-2");$("#content").removeClass("kerning-1 kerning-3");this.processSetChoice("KERNING","kerning-2");break;case"kerning-3":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("kerning-3");$("#content").removeClass("kerning-1 kerning-2");this.processSetChoice("KERNING","kerning-3");break;case"line-1":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("line-1");$("#content").removeClass("line-2 line-3");this.processSetChoice("LINE","line-1");break;case"line-2":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("line-2");$("#content").removeClass("line-1 line-3");this.processSetChoice("LINE","line-2");break;case"line-3":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("line-3");$("#content").removeClass("line-1 line-2");this.processSetChoice("LINE","line-3");break;case"garnitura-1":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("garnitura-1");$("#content").removeClass("garnitura-2 garnitura-3");this.processSetChoice("GARNITURA","garnitura-1");break;case"garnitura-2":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("garnitura-2");$("#content").removeClass("garnitura-1 garnitura-3");this.processSetChoice("GARNITURA","garnitura-2");break;case"voice-1":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("voice-1");$("#content").attr("data-volume",0);$("#content").removeClass("voice-2 voice-3 voice-4");if($("#start_sound").length>0){document.getElementById("start_sound").volume=0}if($("#panel_sound").length>0){document.getElementById("panel_sound").volume=0}if($(".play_voice").length){$(".play_voice").each(function(){$(this)[0].volume=0})}this.processSetChoice("VOICE","voice-1");this.processSetChoice("VOLUME",0);$("#current-volume").text(0);$(".btn-voice-off-on").data("checked","false").find(".glyphicon").removeClass("glyphicon-volume-up").addClass("glyphicon-volume-off");$(".btn-voice-off-on").attr("title",$(".btn-voice-off-on").data("titleoff"));if($("#start_panel_sound").length){$("#start_panel_sound").remove()}break;case"voice-2":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("voice-2");$("#content").removeClass("voice-1 voice-3 voice-4");this.processSetChoice("VOICE","voice-2");var c=0.1;var d=0;d=$("#content").attr("data-volume");if(d>0.1){c=(d-c).toFixed(1)}$("#content").attr("data-volume",c);document.getElementById("start_sound").volume=c;if($(".play_voice").length){$(".play_voice").each(function(){$(this)[0].volume=c})}this.processSetChoice("VOLUME",c);document.getElementById("start_sound").play();$("#current-volume").text(c*100);$(".btn-voice-off-on").data("checked","true").find(".glyphicon").removeClass("glyphicon-volume-off").addClass("glyphicon-volume-up");$(".btn-voice-off-on").attr("title",$(".btn-voice-off-on").data("titleon"));break;case"voice-3":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("voice-3");$("#content").attr("data-volume",0.5);$("#content").removeClass("voice-2 voice-1 voice-4");this.processSetChoice("VOICE","voice-3");document.getElementById("start_sound").volume=0.5;if($(".play_voice").length){$(".play_voice").each(function(){$(this)[0].volume=0.5})}this.processSetChoice("VOLUME",0.5);document.getElementById("start_sound").play();$("#current-volume").text(50);$(".btn-voice-off-on").data("checked","true").find(".glyphicon").removeClass("glyphicon-volume-off").addClass("glyphicon-volume-up");$(".btn-voice-off-on").attr("title",$(".btn-voice-off-on").data("titleon"));break;case"voice-4":b.attr("aria-checked","true").addClass("checked");$("#content").addClass("voice-4");$("#content").removeClass("voice-2 voice-1 voice-3");this.processSetChoice("VOICE","voice-4");var c=0.1;var d=0;d=parseFloat($("#content").attr("data-volume"));if(d<1){c=(c+d).toFixed(1)}else{if(d==1){c=1}}$("#content").attr("data-volume",c);document.getElementById("start_sound").volume=c;if($(".play_voice").length){$(".play_voice").each(function(){$(this)[0].volume=c})}this.processSetChoice("VOLUME",c);document.getElementById("start_sound").play();$("#current-volume").text(c*100);$(".btn-voice-off-on").data("checked","true").find(".glyphicon").removeClass("glyphicon-volume-off").addClass("glyphicon-volume-up");$(".btn-voice-off-on").attr("title",$(".btn-voice-off-on").data("titleon"));break;case"voice-off-on":if(b.data("checked")===false){b.data("checked",true);$(".btn-voice-3").attr("aria-checked","true").addClass("checked");$(".btn-voice-1, .btn-voice-2, .btn-voice-4").removeClass("checked");$("#content").addClass("voice-3");$("#content").attr("data-volume",0.5);$("#content").removeClass("voice-2 voice-1 voice-4");this.processSetChoice("VOICE","voice-3");if($("#start_sound").length>0){document.getElementById("start_sound").volume=0.5}if($(".play_voice").length){$(".play_voice").each(function(){$(this)[0].volume=0.5})}this.processSetChoice("VOLUME",0.5);if($("#start_sound").length>0){document.getElementById("start_sound").play()}$("#current-volume").text(50);b.find(".glyphicon").removeClass("glyphicon-volume-off").addClass("glyphicon-volume-up");b.attr("title",b.data("titleon"))}else{b.data("checked",false);$(".btn-voice-1").attr("aria-checked","true").addClass("checked");$(".btn-voice-2, .btn-voice-3, .btn-voice-4").removeClass("checked");$("#content").addClass("voice-1");$("#content").attr("data-volume",0);$("#content").removeClass("voice-2 voice-3 voice-4");if($("#start_sound").length>0){document.getElementById("start_sound").volume=0}if($("#panel_sound").length>0){document.getElementById("panel_sound").volume=0}if($(".play_voice").length){$(".play_voice").each(function(){$(this)[0].volume=0})}this.processSetChoice("VOICE","voice-1");this.processSetChoice("VOLUME",0);$("#current-volume").text(0);b.find(".glyphicon").removeClass("glyphicon-volume-up").addClass("glyphicon-volume-off");b.attr("title",b.data("titleoff"));if($("#start_panel_sound").length){$("#start_panel_sound").remove()}}break;case"font-switch":if ($("#content").is(".braille")){$("#content").removeClass("braille");this.processSetChoice("FONT_SWITCH", "origin");b.attr("title", b.data("origin"));}else{b.attr("aria-checked", "true").addClass("checked");$("#content").addClass("braille");this.processSetChoice("FONT_SWITCH", "braille");b.attr("title", b.data("braille"));}break;case"reset":bPlaySetting=false;for(i=1;i<=this.$firstButton.length;i++){this.resetMenuChoice(this.$firstButton[i-1])}this.processSetChoice("RESET","Y");if($(".bs-docs-panel").hasClass("voice-panel")){bPlaySetting=true}else{bPlaySetting=false}break;case"setting":if(this.$id.find(".panel-subsetting").is(".active")){this.$id.find(".panel-subsetting").slideUp({duration:"fast",complete:function(){$(this).removeClass("active").attr("aria-hidden","true")},start:function(){}})}else{this.$id.find(".panel-subsetting").slideDown({duration:"fast",complete:function(){$(this).addClass("active").attr("aria-hidden","false")},start:function(){}})}break;case"resume":this.resumeAuth();break;case"no-resume":this.resumeNoAuth();break}};function playSetting(a){var d=0;switch(a){case"reset":d=25;break;case"content":d=29;break;case"font-size-100":d=3;break;case"font-size-150":d=4;break;case"font-size-100":d=3;break;case"font-size-200":d=5;break;case"color-1":d=6;break;case"color-2":d=7;break;case"color-3":d=8;break;case"color-4":d=9;break;case"color-5":d=10;break;case"images":d=11;break;case"not-images":d=12;break;case"mono":if($("#content").is(".mono")){d=14}else{d=13}break;case"flash":if($("#content").is(".not-flash")){d=16}else{d=15}break;case"kerning-1":d=17;break;case"kerning-2":d=18;break;case"kerning-3":d=19;break;case"line-1":d=20;break;case"line-2":d=21;break;case"line-3":d=22;break;case"garnitura-1":d=23;break;case"garnitura-2":d=24;break;case"voice-1":d=28;break;case"exit":d=2;break;case"setting":if($(".access-toolbar").find(".panel-subsetting").is(".active")){d=27}else{d=26}break;case"font-switch":if($("#content").is(".braille")){d=31}else{d=30}break}if(d!=0&&bPlaySetting){var c=$("audio#panel_sound").attr("data-src")+d+".mp3";$("audio#panel_sound").attr("src",c);var b=document.querySelector("audio#panel_sound");if($("#content").hasAttr("data-volume")){b.volume=parseFloat($("#content").attr("data-volume"))}else{b.volume=0.5}b.play()}}toolbar.prototype.resetMenuChoice=function(b){var a=b.attr("data-choice");switch(a){default:b.trigger("click");return false;case"content":break;case"reset":break;case"setting":break;case"voice-off-on":if($("#content").attr("data-volume")!=0){break}else{b.trigger("click");return false}case"images":if($("#content").is(".not-images")){b.trigger("click")}break;case"flash":if($("#content").is(".not-flash")){b.trigger("click")}break;case"voice-1":$(".btn-voice-3").trigger("click");break;case"mono":if($("#content").is(".mono")){b.trigger("click")}break;case"font-switch":if($("#content").is(".braille")){b.trigger("click")}break}};toolbar.prototype.resumeNoAuth=function(){if($(".panel-auth").is(".active")){$(".panel-auth").slideUp({duration:"fast",complete:function(){$(".panel-auth").removeClass("success active").attr("aria-hidden","true");$(".panel-auth button:first").focus();$(".panel-auth h3").attr("tabindex","-1");$(".panel-auth p").attr("tabindex","-1");$(".panel-auth input").attr("tabindex","-1");$(".panel-auth button").attr("tabindex","-1");if($focused.parents("#content").is("div")){$.scrollTo($focused,300,function(){$focused.focus()})}},start:function(){}})}};toolbar.prototype.resumeAuth=function(){if($(".panel-auth").is(".success")){$(".panel-auth").slideUp({duration:"fast",complete:function(){$(".panel-auth").removeClass("success active").attr("aria-hidden","true");$(".panel-auth button:first").focus();$(".panel-auth h3").attr("tabindex","-1");$(".panel-auth p").attr("tabindex","-1");$(".panel-auth input").attr("tabindex","-1");$(".panel-auth button").attr("tabindex","-1");if($focused.parents("#content").is("div")){$.scrollTo($focused,300,function(){$focused.focus()})}},start:function(){}})}else{$("#panel_auth_form").trigger("submit")}};